<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L3 Main Message</title>
    <script src="js/spx_interface.js"></script>
    <link rel="stylesheet" type="text/css" href="css/spx_fonts.css" />
    <link rel="stylesheet" type="text/css" id="DynamicTheme" href="themes/default.css" />
    <link rel="stylesheet" href="./L3_MAIN_MESSAGE/L3_MAIN_MESSAGE.css">
    <script>
        let interval;
        let timeCode = '';
        const sequenceDuration = 5000;

        function runTemplateUpdate() {
            timeCode = document.getElementById('f1').innerText;
        }

        function runAnimationIN() {
        }

        function runAnimationNEXT() {
            const countdownContainer = document.querySelector('.countdown');
            const mainTitleContainer = document.querySelector('.main-title');
            const countdownElements = document.querySelectorAll('.countdown span, .main-title span');
            countdownElements.forEach((el) => {
                el.style.animation = 'fadeOutUp 1s ease-in-out forwards';
            });

            setTimeout(() => {
                countdownContainer.style.display = 'none';
                mainTitleContainer.style.display = 'none';
                const happyNewYearContainer = document.querySelector('.new-year');
                happyNewYearContainer.style.display = 'inline-block';
                const happyNewYearElements = document.querySelectorAll('.new-year span');
                happyNewYearElements.forEach((el, index) => {
                    el.classList.add('new-year-animation');
                    el.style.animationDelay =  `${index * 0.35}s`;
                });
                triggerLocations(timeCode);
            }, 500);
        }

        function runAnimationOUT() {
            const container = document.querySelector('.container');
            container.style.animation = 'fadeOutUp 1s ease-in-out forwards';
            clearInterval(interval);
        }

        function runSequence() {
            const sparks = document.querySelectorAll('.spark-1, .spark-2, .spark-3, .spark-4, .spark-5, .spark-6, .spark-7, .spark-8, .spark-9');
            const textSpans = document.querySelectorAll('.main-title span, .countdown span');
            
            // Reset animations
            sparks.forEach(s => s.classList.remove('animate'));
            textSpans.forEach((s, index) => {
                s.classList.remove('animate');
                s.style.animation = ''; // Clear any inline animation styles
                s.style.animationDelay = `${index * 0.04}s`;
            });
            
            // Force reflow to restart CSS animations
            if(sparks.length > 0) void sparks[0].offsetWidth; 

            // Start Sparks in specific order: 1, 6, 2, 7, 3, 4, 5, 8, 9
            const sparkOrder = ['.spark-1', '.spark-6', '.spark-2', '.spark-7', '.spark-3', '.spark-4', '.spark-5', '.spark-8', '.spark-9'];
            
            sparkOrder.forEach((selector, index) => {
                const el = document.querySelector(selector);
                if (el) {
                    setTimeout(() => {
                        el.classList.add('animate');
                    }, index * 200);
                }
            });

            // Start Text 0.5s after start
            setTimeout(() => {
                textSpans.forEach(s => s.classList.add('animate'));
            }, 600);

            // Animate out text spans at the end of the sequence
            setTimeout(() => {
                textSpans.forEach(s => {
                    s.style.animation = 'fadeOutUp 1s ease-in-out forwards';
                });
            }, sequenceDuration - 1000);
        }

        window.onload = function() {
            document.querySelectorAll('.main-title span, .countdown span').forEach((letter, index) => {
                letter.style.animationDelay = `${index * 0.02}s`;
            });

            runSequence();
            setInterval(runSequence, sequenceDuration);
        }

        const locations = {
            NT: [
                "St. John’s", "Mount Pearl", "Clarenville", "Grand Bank", "Fortune",
                "Point May", "Chance Cove", "Fogo Island", "Musgrave Harbour", 
                "Stephenville", "Flowers Cove", "Three Mile Rock", "Port Saunders", 
                "Bishop’s Falls", "Baie Verte", "Deer Lake", "St. Alban’s", 
                "Grand Falls-Windsor", "Harbour Main", "Paradise", "Placentia", 
                "Conception Bay South", "Bay Bulls", "Burnt Cove", "Cootes Pond"
            ],
            AT: [
                "Charlottetown", "Cape Breton Island", "Fredericton", "Cavendish", 
                "Bridgewater", "Bathurst", "Labrador City", "Bay Fortune", 
                "Wolfville", "Grand Falls", "Halifax", "Quispamsis", "Kensington", 
                "Oromocto", "Antigonish", "Miscouche", "Digby", "Moncton", "Tignish", 
                "Pictou", "Saint John", "Tyne Valley", "Yarmouth", "Caraquet", 
                "Cardigan"
            ],
            ET: [
                "Iqaluit", "Mirabel", "Kimmirut", "Brantford", "Trois-Rivières", 
                "Strathroy", "Kuujjuaq", "Timmins", "Rivière-du-Loup", "North Bay", 
                "Rimouski", "Chicoutimi", "Saguenay", "Ingersoll", "Petrolia", 
                "Tilbury", "Cornwall", "Thunder Bay", "Laval", "Portneuf", 
                "Burlington", "Baie-Comeau", "Oshawa", "Gaspé", "Turkey Point", 
                "Waterdown"
            ],
            CT: [
                "Flin Flon", "La Loche", "Arviat", "The Pas", "La Ronge", 
                "Kindersley", "Yorkton", "Qamani'tuaq", "Mistuhekasookun", 
                "Churchill", "Melville", "Weyburn", "Prince Albert", "Stanley Mission", 
                "Neepawa", "Humboldt", "Meadow Lake", "Winkler", "Lac du Bonnet", 
                "Swan River", "Estevan", "Fort Qu'Appelle", "Thompson", 
                "Steinbach", "Dawson Bay"
            ],
            MT: [
                "Red Deer", "Yellowknife", "Okotoks", "Old Crow", "Hay River", 
                "Jasper", "Behchokǫ̀", "Wekweètì", "Whitehorse", "Tuktoyaktuk", 
                "Grande Prairie", "Dawson City", "Inuvik", "Whatì", "Creston", 
                "Fort McMurray", "High Level", "Kugluktuk", "Peerless Lake", 
                "Burwash Landing", "Medicine Hat", "Aklavik", "Airdrie", 
                "Liard River", "Canmore", "Fox Creek", "Keg River", "Lac La Biche", 
                "Kimball", "Steen River", "Fort St. John"
            ],
            PT: [
                "Osoyoos", "Lillooet", "Nanaimo", "Kyuquot", "Hope",
                "Williams Lake", "Prince Rupert", "Burns Lake", "Chilliwack",
                "Bowen Island", "Maple Ridge", "Langley", "Vancouver", "Victoria", 
                "Kamloops", "Revelstoke", "Winter Harbour", "Iskut", "100 Mile House", 
                "Surrey", "Powell River", "Blue River", "Fraser", "Whistler", "Kaslo"
            ]
        };

        function triggerLocations(timeCode) {
            const locationSpan = document.querySelector('.location');
            locationSpan.style.display = 'inline-block';
            startCountdown(timeCode);
        }

        function startCountdown(timeCode) {
            clearInterval(interval);
            const selectedArray = locations[timeCode];
            let count = 0;
            let maxItems = selectedArray.length;
            interval = setInterval(() => {
                const locationSpan = document.querySelector('.location');
                locationSpan.textContent = selectedArray[count];
                count++;
                if (count >= maxItems) {
                    count = 0;
                }
            }, 1000);
        }
    </script>
    <script type="text/javascript">
        window.SPXGCTemplateDefinition = {
            "defversion": "1",
            "description": "Main Message",
            "playserver": "OVERLAY",
            "playchannel": "2",
            "playlayer": "9",
            "webplayout": "9",
            "out": "manual",
            "dataformat": "json",
            "steps": "2",
            "uicolor": "1",
            "DataFields": [
                {
                    "field": "f1",
                    "ftype": "dropdown",
                    "title": "Time Zone",
                    "value": "ET",
                    "items": [
                        {
                            "text": "Newfoundland",
                            "value": "NT"
                        },
                        {
                            "text": "Atlantic",
                            "value": "AT"
                        },
                        {
                            "text": "Eastern",
                            "value": "ET"
                        },
                        {
                            "text": "Central",
                            "value": "CT"
                        },
                        {
                            "text": "Mountain",
                            "value": "MT"
                        },
                        {
                            "text": "Pacific",
                            "value": "PT"
                        }
                    ]
                },
                {
                    "ftype": "spacer"
                }
            ]
        };
    </script>
</head>

<body>
    <div class="container">
        <h1>
            <span class="main-title">
                <span>L</span><span>I</span><span>V</span><span>E</span><span>!</span>
              </span>
              <span class="countdown">
                <span>C</span><span>r</span><span>o</span><span>s</span><span>s</span><span style="margin-right:-10px">-</span>
                <span>C</span><span>a</span><span>n</span><span>a</span><span>d</span><span>a</span> 
                <span>C</span><span>o</span><span>u</span><span>n</span><span>t</span><span>d</span><span>o</span><span>w</span><span>n</span>
              </span>
              <span class="new-year">
                <span>Happy</span>
                <span>New</span>
                <span>Year!</span>
              </span>
              <span class="location"></span>
        </h1>

        <div class="main-sparks">
            <!-- Spark 1 (Quarter Yellow)-->
            <div class="spark-1">
                <!-- Line 1 -->
                <div class="spark-1-yellow-wrapper">
                    <div class="spark-1-line spark-1-pos-top"></div>
                    <div class="spark-1-line spark-1-pos-bottom"></div>
                    <div class="spark-1-line spark-1-pos-left"></div>
                    <div class="spark-1-line spark-1-pos-right"></div>
                </div>
                <!-- Line 2 -->
                <div class="spark-1-blue-wrapper">
                    <div class="spark-1-line spark-1-pos-top"></div>
                    <div class="spark-1-line spark-1-pos-bottom"></div>
                    <div class="spark-1-line spark-1-pos-left"></div>
                    <div class="spark-1-line spark-1-pos-right"></div>
                </div>
                <!-- SVG -->
                <img src="./L3_MAIN_MESSAGE/quarter.svg" alt="quarter gem" class="spark-1-ring-svg">
            </div>
            <!-- Spark 2 (Half Teal) -->
            <div class="spark-2">
                <!-- Line 1 -->
                <div class="spark-2-yellow-wrapper">
                    <div class="spark-2-line spark-2-pos-top"></div>
                    <div class="spark-2-line spark-2-pos-bottom"></div>
                    <div class="spark-2-line spark-2-pos-left"></div>
                    <div class="spark-2-line spark-2-pos-right"></div>
                </div>
                <!-- Line 2 -->
                <div class="spark-2-blue-wrapper">
                    <div class="spark-2-line spark-2-pos-top"></div>
                    <div class="spark-2-line spark-2-pos-bottom"></div>
                    <div class="spark-2-line spark-2-pos-left"></div>
                    <div class="spark-2-line spark-2-pos-right"></div>
                </div>
                <!-- Half -->
                <svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 125.17 62.59" class="spark-2-ring-svg">
                  <path fill="currentColor" d="M125.17,62.59C125.17,28.07,97.1,0,62.59,0S0,28.07,0,62.59h125.17Z"/>
                </svg>
            </div>
            <!-- Spark 3 (Half White) -->
            <div class="spark-3">
                <!-- Line 1 -->
                <div class="spark-3-yellow-wrapper">
                    <div class="spark-3-line spark-3-pos-top"></div>
                    <div class="spark-3-line spark-3-pos-bottom"></div>
                    <div class="spark-3-line spark-3-pos-left"></div>
                    <div class="spark-3-line spark-3-pos-right"></div>
                </div>
                <!-- Line 2 -->
                <div class="spark-3-blue-wrapper">
                    <div class="spark-3-line spark-3-pos-top"></div>
                    <div class="spark-3-line spark-3-pos-bottom"></div>
                    <div class="spark-3-line spark-3-pos-left"></div>
                    <div class="spark-3-line spark-3-pos-right"></div>
                </div>
                <!-- Half -->
                <svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 125.17 62.59" class="spark-3-ring-svg">
                  <path fill="currentColor" d="M125.17,62.59C125.17,28.07,97.1,0,62.59,0S0,28.07,0,62.59h125.17Z"/>
                </svg>
            </div>
            <!-- Spark 4 (Yellow No Shape) -->
            <div class="spark-4">
                <!-- Line 1 -->
                <div class="spark-4-yellow-wrapper">
                    <div class="spark-4-line spark-4-pos-top"></div>
                    <div class="spark-4-line spark-4-pos-bottom"></div>
                    <div class="spark-4-line spark-4-pos-left"></div>
                    <div class="spark-4-line spark-4-pos-right"></div>
                </div>
                <!-- Line 2 -->
                <div class="spark-4-blue-wrapper">
                    <div class="spark-4-line spark-4-pos-top"></div>
                    <div class="spark-4-line spark-4-pos-bottom"></div>
                    <div class="spark-4-line spark-4-pos-left"></div>
                    <div class="spark-4-line spark-4-pos-right"></div>
                </div>
            </div>
            <!-- Spark 5 (Red No Shape) -->
            <div class="spark-5">
                <!-- Line 1 -->
                <div class="spark-5-yellow-wrapper">
                    <div class="spark-5-line spark-5-pos-top"></div>
                    <div class="spark-5-line spark-5-pos-bottom"></div>
                    <div class="spark-5-line spark-5-pos-left"></div>
                    <div class="spark-5-line spark-5-pos-right"></div>
                </div>
                <!-- Line 2 -->
                <div class="spark-5-blue-wrapper">
                    <div class="spark-5-line spark-5-pos-top"></div>
                    <div class="spark-5-line spark-5-pos-bottom"></div>
                    <div class="spark-5-line spark-5-pos-left"></div>
                    <div class="spark-5-line spark-5-pos-right"></div>
                </div>
            </div>
            <!-- Spark 6 (Group)-->
            <div class="spark-6">
                <!-- Line 1 -->
                <div class="yellow-wrapper">
                    <div class="line pos-top"></div>
                    <div class="line pos-bottom"></div>
                    <div class="line pos-left"></div>
                    <div class="line pos-right"></div>
                </div>
                <!-- Line 2 -->
                <div class="blue-wrapper">
                    <div class="line pos-top"></div>
                    <div class="line pos-bottom"></div>
                    <div class="line pos-left"></div>
                    <div class="line pos-right"></div>
                </div>
                <svg class="ring-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 250.35 125.17">
                <path class="part-1" d="M62.59,125.17C28.02,125.17,0,97.15,0,62.59S28.02,0,62.59,0s62.59,28.02,62.59,62.59-28.02,62.59-62.59,62.59"/>
                <path class="part-2" d="M125.17,125.17c34.52,0,62.59-28.07,62.59-62.59S159.69,0,125.17,0v125.17Z"/>
                <path class="part-3" d="M219.05,125.17c18.71-12.49,31.29-35.84,31.29-62.59S237.76,12.49,219.05,0v125.17Z"/>
                <path class="part-4" d="M187.76,125.17c18.71-12.49,31.29-35.84,31.29-62.59S206.47,12.49,187.76,0v125.17Z"/>
                </svg>
            </div>
            <!-- Spark 7 (Duplicate of Spark 1) -->
            <div class="spark-7">
                <!-- Line 1 -->
                <div class="spark-7-yellow-wrapper">
                    <div class="spark-7-line spark-7-pos-top"></div>
                    <div class="spark-7-line spark-7-pos-bottom"></div>
                    <div class="spark-7-line spark-7-pos-left"></div>
                    <div class="spark-7-line spark-7-pos-right"></div>
                </div>
                <!-- Line 2 -->
                <div class="spark-7-blue-wrapper">
                    <div class="spark-7-line spark-7-pos-top"></div>
                    <div class="spark-7-line spark-7-pos-bottom"></div>
                    <div class="spark-7-line spark-7-pos-left"></div>
                    <div class="spark-7-line spark-7-pos-right"></div>
                </div>
                <!-- SVG -->
                <img src="./L3_MAIN_MESSAGE/quarter.svg" alt="quarter gem" class="spark-7-ring-svg">
            </div>
            <!-- Spark 8 (Duplicate of Spark 4) -->
            <div class="spark-8">
                <!-- Line 1 -->
                <div class="spark-8-yellow-wrapper">
                    <div class="spark-8-line spark-8-pos-top"></div>
                    <div class="spark-8-line spark-8-pos-bottom"></div>
                    <div class="spark-8-line spark-8-pos-left"></div>
                    <div class="spark-8-line spark-8-pos-right"></div>
                </div>
                <!-- Line 2 -->
                <div class="spark-8-blue-wrapper">
                    <div class="spark-8-line spark-8-pos-top"></div>
                    <div class="spark-8-line spark-8-pos-bottom"></div>
                    <div class="spark-8-line spark-8-pos-left"></div>
                    <div class="spark-8-line spark-8-pos-right"></div>
                </div>
            </div>
            <!-- Spark 9 (Duplicate of Spark 5) -->
            <div class="spark-9">
                <!-- Line 1 -->
                <div class="spark-9-yellow-wrapper">
                    <div class="spark-9-line spark-9-pos-top"></div>
                    <div class="spark-9-line spark-9-pos-bottom"></div>
                    <div class="spark-9-line spark-9-pos-left"></div>
                    <div class="spark-9-line spark-9-pos-right"></div>
                </div>
                <!-- Line 2 -->
                <div class="spark-9-blue-wrapper">
                    <div class="spark-9-line spark-9-pos-top"></div>
                    <div class="spark-9-line spark-9-pos-bottom"></div>
                    <div class="spark-9-line spark-9-pos-left"></div>
                    <div class="spark-9-line spark-9-pos-right"></div>
                </div>
            </div>
        </div>

        <div style="display:none;"  id="f1"></div>
    </div>
</body>

</html>